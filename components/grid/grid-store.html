<script>
    (function () {

    }());


    createComponent({
        nodeName: 'grid-store',
        setGrid: function (grid) {
            console.log('SET GRID');
            this.grid = grid;
            this.grid.addEventListener('sort', this.onSort.bind(this));
            this.grid.addEventListener('pagination', this.onPaginate.bind(this));
        },
        domReady: function () {
            this.pagination = {};
            this.sort = {};

            var
                url = this.getAttribute('url'),
                restURL = this.getAttribute('restURL');

            if(this.dataPropertyName){
                this.data = window[this.dataPropertyName];
                console.log('data', this.data);
                // time out needed to prevent content flash
                setTimeout(function () {
                    this.parseData(this.data);
                }.bind(this), 1);
            }
            else if(this.restURL){
                this.ajax = document.createElement('core-ajax');
                this.GET();
            }
            else if(url){
                this.get(url);
            }
        },
        get: function (url) {
            xhr(url, function (data) {
                this.data = data;
                console.log('DATA', this.data);
                this.parseData(this.data);
            }.bind(this));
        },
        parseData: function (data) {

            this.data = data;
            this.items = data.items;
            this.orgItems = [].concat(this.items);

            var
                columns = Object.keys(this.items[0]);

            this.grid.render(this.items, columns);
            this.grid.fire('data', {data: this.data});

        },
        onSort: function (event) {
            if(this.dataPropertyName){
                this.grid.render(this.memorySort(event), false);
            }
            else{
                console.log('url sort', event.detail);
            }
        },
        onPaginate: function (event) {
            console.log('onPaginate', event.detail.params);
            this.pagination.start = event.detail.params.start;
            this.pagination.count = event.detail.params.count;
        },
        created: function () {
            console.log('~created callback', this.getAttribute('url'));
        },
        attached: function () {
            console.log('~attached callback', this);
        }
    });

</script>